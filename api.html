<!DOCTYPE html>
<html>

<head>
  <title>CZL Chat API</title>
  <meta charset="utf-8">
  <link rel="stylesheet" href="https://unpkg.com/mdui@1.0.2/dist/css/mdui.min.css" />
  <script>
    function requestToken() {
      // console.log("Requesting token");

      // 向父窗口发送请求 token 的消息
      window.parent.postMessage({ type: "request-token" }, "https://chat.czl.net");
    }

    function getToken() {


      // 添加事件侦听器
      window.addEventListener("message", function (event) {

        // 验证消息来源和类型
        if (event.origin === "https://chat.czl.net" && event.data.type === "token") {
          // 提取 "data" 属性的值
          var data = event.data.data;
          // 构建新的令牌字符串
          var czlchat_token = JSON.parse(data).data;
          // 在页面上显示令牌字符串
          document.getElementById("token").value = czlchat_token;
          // 重新初始化文本框
          mdui.updateTextFields();
        }
      });
    }
    // 在页面加载时自动调用 getToken() 函数
    document.addEventListener("DOMContentLoaded", function () {
      getToken();
    });


  </script>
  <style>
    body {
      font-family: -apple-system, BlinkMacSystemFont, Segoe UI, Noto Sans, Helvetica, Arial, sans-serif, "Apple Color Emoji", "Segoe UI Emoji";
    }

    .mdui-typo pre {
      white-space: pre-wrap;
      /* 允许换行 */
      word-break: break-all;
      /* 单词内允许断行 */
    }
    .mdui-card{
        border-radius: 8px;
    }
  </style>
</head>

<body
  class="mdui-appbar-with-toolbar mdui-bottom-nav-fixed mdui-theme-primary-indigo mdui-theme-accent-indigo mdui-color-grey-50"
  style="padding-bottom:280px;">
  <div class="mdui-appbar mdui-appbar-fixed mdui-valign " style="background-color: #1e3b7a;color:aliceblue">
    <h1 class="mdui-typo-title mdui-center mdui-p-a-1">CZL Chat API说明</h1>
  </div>
  <div class="mdui-container mdui-typo">
    <div class="mdui-m-t-3">
      <div>
        <h2 style="display: inline-block;">获取密钥</h2>
        <p style="display: inline-block; font-size: smaller;"><mark
            class="mdui-p-a-1">密钥有效期为30天，但不是从生成的时候开始算，而是从初次登录开始计算。失效时记得来重新获取一次。</mark></p>
      </div>
      <div class="mdui-row  mdui-valign" style="height:50px;">

        <button onclick="requestToken()"
          class="mdui-btn mdui-col-xs-2 mdui-color-theme mdui-ripple mdui-m-y-1 mdui-m-x-2">获取</button>


        <div class=" mdui-m-y-1  mdui-col-xs-10 mdui-valign mdui-m-x-2 mdui-textfield">
          <i class="mdui-icon material-icons" onclick="copyToken()"
            mdui-tooltip="{content: '复制密钥', position: 'top'}">content_copy</i>
          <!--<pre id="token">点击按钮后密钥会显示在这里</pre>-->
          <input class="mdui-textfield-input mdui-text-truncate" id="token" type="text" placeholder="点击按钮后密钥会显示在这里"
            disabled />

        </div>
      </div>
    </div>
    <div class="mdui-divider mdui-m-y-2"></div>
    <div class="mdui-m-t-3">
      <h2>调用接口</h2>
      <div class="mdui-panel mdui-panel-gapless " mdui-panel="{accordion: true}">
        <div class="mdui-panel-item ">
          <div class="mdui-panel-item-header mdui-hoverable">
            <div class="mdui-panel-item-title">CZL 3.5模型</div>
            <div class="mdui-panel-item-summary">接口地址：https://czlchat-api.czl.net/v1/chat/completions</div>
            <i class="mdui-panel-item-arrow mdui-icon material-icons">keyboard_arrow_down</i>
          </div>
          <div class="mdui-panel-item-body  mdui-color-grey-50">
            <div class="mdui-p-y-2">
              <p><strong>请注意该接口不支持上下文关联，但可以自己拼接来达到类似效果；</strong></p>
              <p><strong>请求方式与OPENAI相同，只是地址不同</strong></p>

              <p>接口地址：<code>https://czlchat-api.czl.net/v1/chat/completions</code></p>
              <p>
                携带参数：Bearer+&quot;密钥&quot;,例子：
              <pre>Authorization:Bearer eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJNZW1iZXJJZCI6MTMwNjI3OTI3OTMwMjksIkFjY291bnQiOiIxNTIyMTY1NzUxNSIsIkFj*******Y291bnRUeX******NrTmFtZSI6Indvb2RAY3psLm5ldCIsIkxvZ2luTW9kZSI6MiwiaWF0IjoxNjg2NjQyMDY1LCJuYmYiOjE2ODY2NDIwNjUsImV4cCI6MTY4OTIzNDA2NSwiaXNzIjoiQ1pMQUlDaGF0IiwiYXVkIjoiQ1pMQUlDaGF0In0.cZqLf6qMi6WGIdP_Fhq0</pre>

              <p>
                请求格式：<code>{&quot;model&quot;:&quot;gpt-3.5-turbo&quot;,&quot;messages&quot;:[{&quot;role&quot;:&quot;user&quot;,&quot;content&quot;:&quot;红烧肉的做法&quot;}]}</code>
              </p>
              <p>返回格式：</p>
              <p class="mdui-typo-wrap">
              <pre>{"id":"*****","object":"chat.completion","created":*****,"model":"gpt-3.5-turbo","usage":{"prompt_tokens":10,"completion_tokens":18,"total_tokens":28},"choices":[{"message":{"role":"assistant","content":"红烧肉是一道非常经典的中国菜肴。下面是简单的做法：\n\n**材料：**\n- 猪肉五花肉（500克）\n- 姜块（4-5片）\n- 葱段（2根）\n- 料酒（适量）\n- 生抽（适量）\n- 红糖（适量）\n- 八角（2-3个）\n- 桂皮（1块）\n- 老抽（适量）\n- 盐（适量）\n- 清水（适量）\n\n**步骤：**\n1. 猪肉洗净切成2厘米见方的块，用开水焯水去掉血水，捞出过冷水冲洗干净。\n2. 热锅凉油，下姜片和葱段爆香，再加入五花肉块煸炒至两面焦黄。\n3. 加入料酒煮至酒精挥发，加入开水淹没肉块，加入适量生抽、老抽、盐、红糖、八角和桂皮（可依个人口味调整）。\n4. 用中小火煮至水分只剩少量时，换小火用砂锅继续炖煮30分钟左右，同时注意搅拌，防止粘锅。\n5. 待汁水炖至浓稠时，关火食用。\n\n注：如果喜欢肉质更加软烂，可以将煮过的肉块拿出来切成小块，再放回锅中继续炖煮。"},"finish_reason":"stop","index":0}]}</pre>
              </p>
            </div>
          </div>
        </div>
      </div>
      <div class="mdui-panel-item">
        <div class="mdui-panel-item-header mdui-hoverable">
          <div class="mdui-panel-item-title">CZL 4模型</div>
          <div class="mdui-panel-item-summary">暂未开放</div>
          <!-- <i class="mdui-panel-item-arrow mdui-icon material-icons">keyboard_arrow_down</i> -->
        </div>

      </div>
    </div>

    <div class="mdui-divider mdui-m-y-2"></div>
    <div class="mdui-m-t-3">
      <h2>使用说明</h2>
      <div class="mdui-card mdui-hoverable">
        <div class="mdui-card-primary">
          <div class="mdui-card-primary-title">注意事项</div>
        </div>
        <div class="mdui-card-content">



          <div class="mdui-panel mdui-panel-gapless" mdui-panel="{accordion: true}">
            <div class="mdui-panel-item ">
              <div class="mdui-panel-item-header mdui-hoverable">
                <div class="mdui-panel-item-title">2023年6月16日更新</strong></div>
                <!-- <div class="mdui-panel-item-summary">即以下方式的请求格式，只支持上面接口说明处的格式</div> -->
                <i class="mdui-panel-item-arrow mdui-icon material-icons">keyboard_arrow_down</i>
              </div>
              <div class="mdui-panel-item-body  mdui-color-grey-50">
                <div class="mdui-p-y-2 ">
                  <ol>
                    <li>6月16日更新，增加流式输出（不过没发现有啥用，反正思源笔记也不支持）。</li>
                    <li>在notion不能用，可能是我不会，好像notion不支持自定义key和接口，只能使用notion的会员？</li>
                    <li>
                      在部分开源的chatgpt项目中无法使用，比如chatgpt-next-web，是因为这个项目自己先自定义发送了一条预定角色信息，接口的确返回了第二次的提问（实际的提问）答案，但是项目里不会显示出来，反而显示在对话标题。如图<img
                        alt="image.png" src="https://cdn-img.czl.net/2023/06/16/pgb1xm.png" /> </li>
                  </ol>
                </div>
              </div>
            </div>
            <div class="mdui-panel-item ">
              <div class="mdui-panel-item-header mdui-hoverable">
                <div class="mdui-panel-item-title">CZL-3.5模型<strong>不支持上下文对话</strong></div>
                <div class="mdui-panel-item-summary">即以下方式的请求格式，只支持上面接口说明处的格式</div>
                <i class="mdui-panel-item-arrow mdui-icon material-icons">keyboard_arrow_down</i>
              </div>
              <div class="mdui-panel-item-body  mdui-color-grey-50">
                <div class="mdui-p-y-2">
                  <pre>{"model":"gpt-3.5-turbo","messages":[{"role":"system","content":"You are a photographer. "},{"role":"system","content":"You need to output templates related to your field of expertise that will be used to generate prompts by English."},{"role":"user","content":"Give me a creative idea"}],"max_tokens":50,"n":1,"stop":null,"temperature":1}</pre>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
    <div class="mdui-row">
      <div class="mdui-card mdui-hoverable mdui-col-xs-6 mdui-m-t-2" style="height:220px">
        <div class="mdui-card-primary">
          <div class="mdui-card-primary-title">使用场景</div>
        </div>
        <div class="mdui-card-content ">
          <ol>
            <li>可以在诸如：VS CODE、Notion、思源笔记等提供OPENAI接口的软件/插件处使用CZL Chat的服务，无需担心OPENAI封号、稳定等的问题，使用量大的情况下CZL
              Chat的价格也比OPENAI要更低；</li>
            <li>自定义开发应用：可使用接口自定义开发应用；</li>
          </ol>
        </div>
      </div>
      <div class="mdui-card mdui-hoverable mdui-col-xs-6 mdui-m-t-2" style="height:220px">
        <div class="mdui-card-primary">
          <div class="mdui-card-primary-title">计费说明</div>
        </div>
        <div class="mdui-card-content">
          <p>按照使用token计费,可在登录端点击“头像-账户”处查看消耗记录。
            <img alt="image" src="https://cdn-img.czl.net/2023/06/14/t0ffti.png" />
          </p>
        </div>
      </div>
    </div>


    <div class="mdui-divider mdui-m-y-2"></div>
    <div class="mdui-m-t-3">
      <h2>视频说明</h2>
      <div class="mdui-video-container">
        <iframe src="//player.bilibili.com/player.html?aid=399850730&bvid=BV1vo4y177Gf&cid=1163978070&page=1"
          scrolling="no" border="0" frameborder="no" framespacing="0" allowfullscreen="true"> </iframe>
      </div>

    </div>

  </div>
  <div id="spinner-container"
    style="position: fixed; top: 0; left: 0; right: 0; bottom: 0; display: flex; align-items: center; justify-content: center; background: rgba(255, 255, 255, 0.5); z-index: 100;"
    class="spinner-container">
    <div class="mdui-spinner mdui-spinner-colorful"></div>
  </div>


  <script src="https://unpkg.com/mdui@1.0.2/dist/js/mdui.min.js"></script>
  <script>
    // 显示进度指示器的函数
    function showSpinner() {
      document.getElementById("spinner-container").style.display = "flex";
    }

    // 隐藏进度指示器的函数
    function hideSpinner() {
      document.getElementById("spinner-container").style.display = "none";
    }
    function copyToken() {
      const token = document.querySelector('#token').value;
      const textarea = document.createElement('textarea');
      textarea.value = token;
      document.body.appendChild(textarea);
      textarea.select();
      try {
        document.execCommand('copy');
        mdui.snackbar({
          message: '复制成功',
          position: 'top'
        });
      } catch (err) {
        console.error('Error copying token: ', err);
        mdui.snackbar({
          message: '复制失败',
          position: 'top'
        });
      } finally {
        document.body.removeChild(textarea);
      }
    }
    // 在页面加载完成后隐藏进度指示器
    window.onload = function () {
      hideSpinner();
    }
  </script>
</body>

</html>